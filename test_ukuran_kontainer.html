<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Test Ukuran Kontainer</title>
    </head>
    <body>
        <h1>Test Logika Ukuran Kontainer untuk Perbaikan Kontainer</h1>

        <form>
            <div>
                <label for="kegiatan">Kegiatan:</label>
                <select id="kegiatan">
                    <option value="">Pilih Kegiatan</option>
                    <option value="antar kontainer sewa">
                        ANTAR KONTAINER SEWA
                    </option>
                    <option value="perbaikan kontainer">
                        PERBAIKAN KONTAINER
                    </option>
                    <option value="tarik kontainer sewa">
                        TARIK KONTAINER SEWA
                    </option>
                </select>
            </div>

            <div>
                <label for="jumlah_kontainer">Jumlah Kontainer:</label>
                <input type="number" id="jumlah_kontainer" value="1" min="1" />
            </div>

            <div>
                <label for="ukuran">Ukuran Kontainer:</label>
                <select id="ukuran">
                    <option value="">Pilih Ukuran</option>
                    <option value="10">10 ft</option>
                    <option value="20">20 ft</option>
                    <option value="40">40 ft</option>
                </select>
            </div>
        </form>

        <script>
            // Test logika yang sama seperti di create.blade.php
            const kegiatanSelect = document.getElementById("kegiatan");
            const jumlahKontainerInput =
                document.getElementById("jumlah_kontainer");
            const ukuranKontainerSelect = document.getElementById("ukuran");
            const originalOptions = Array.from(ukuranKontainerSelect.options);

            function updateFormBasedOnJumlah() {
                const jumlah = parseInt(jumlahKontainerInput.value, 10) || 0;
                const currentValue = ukuranKontainerSelect.value;
                const selectedKegiatan = kegiatanSelect.value.toLowerCase();
                const isPerbaikanKontainer =
                    selectedKegiatan.includes("perbaikan kontainer") ||
                    selectedKegiatan.includes("perbaikan");

                console.log("Kegiatan:", selectedKegiatan);
                console.log("Is Perbaikan Kontainer:", isPerbaikanKontainer);

                while (ukuranKontainerSelect.options.length > 0) {
                    ukuranKontainerSelect.remove(0);
                }

                if (isPerbaikanKontainer) {
                    // Untuk perbaikan kontainer, hanya tampilkan 20ft
                    console.log(
                        "Setting ukuran to 20ft for perbaikan kontainer"
                    );
                    ukuranKontainerSelect.add(new Option("20 ft", "20"));
                    ukuranKontainerSelect.value = "20";
                } else {
                    // Untuk kegiatan normal, tampilkan semua ukuran dengan logika jumlah
                    console.log("Setting normal ukuran options");
                    if (jumlah > 1) {
                        originalOptions.forEach((option) => {
                            if (
                                option.value === "10" ||
                                option.value === "20" ||
                                option.value === ""
                            ) {
                                ukuranKontainerSelect.add(
                                    new Option(option.text, option.value)
                                );
                            }
                        });
                        if (currentValue === "40") {
                            ukuranKontainerSelect.value = "";
                        } else {
                            ukuranKontainerSelect.value = currentValue;
                        }
                    } else {
                        originalOptions.forEach((option) => {
                            ukuranKontainerSelect.add(
                                new Option(option.text, option.value)
                            );
                        });
                        ukuranKontainerSelect.value = currentValue;
                    }
                }

                console.log(
                    "Current ukuran value:",
                    ukuranKontainerSelect.value
                );
                console.log(
                    "Available options:",
                    Array.from(ukuranKontainerSelect.options).map((o) => o.text)
                );
                console.log("---");
            }

            // Event listeners
            kegiatanSelect.addEventListener("change", () => {
                updateFormBasedOnJumlah();
            });

            jumlahKontainerInput.addEventListener("input", () => {
                updateFormBasedOnJumlah();
            });

            // Initial call
            updateFormBasedOnJumlah();
        </script>
    </body>
</html>
